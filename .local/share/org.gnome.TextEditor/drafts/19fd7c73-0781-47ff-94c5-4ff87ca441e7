#!/bin/bash

# Set date/time
report_date=$(date '+%Y-%m-%d %H:%M:%S')

# Gather system information
hostname=$(hostname)
source /etc/os-release
uptime=$(uptime -p)

# Gather hardware information
cpu=$(lscpu | grep "Model name" | cut -d ':' -f2 | sed 's/^[ \t]*//')
ram=$(free -h | grep "Mem" | awk '{print $2}')
disk=$(lsblk -d -o NAME,SIZE,MODEL | grep -v "NAME" | sed 's/^/Disk: /')
video=$(lspci | grep VGA | cut -d ' ' -f5-)

# Gather network information
fqdn=$(hostname -f)
host_address=$(ip a | grep inet | grep global | awk '{print $2}' | cut -d '/' -f1)
gateway_ip=$(ip r | grep default | awk '{print $3}')
dns_server=$(cat /etc/resolv.conf | grep nameserver | awk '{print $2}')

# Gather system status information
users_logged_in=$(who | awk '{print $1}' | sort | uniq | tr '\n' ',' | sed 's/,$//')
disk_space=$(df -h | grep -E '^/dev' | awk '{print $1, $4}' | tr '\n' ', ' | sed 's/,$//')
process_count=$(ps aux --no-headers | wc -l)
load_averages=$(uptime | awk -F'load average:' '{print $2}' | sed 's/^[ \t]*//')
listening_ports=$(ss -tuln | grep -oP '\d+(?=:)' | sort -u | tr '\n' ',' | sed 's/,$//')
ufw_status=$(ufw status | head -n 1 | awk '{print $2}')

# Generate system report
cat <<EOF

System Report generated by $(whoami), $report_date

System Information
------------------
Hostname: $hostname
OS: $NAME $VERSION
Uptime: $uptime

Hardware Information
--------------------
CPU: $cpu
RAM: $ram
Disk(s): $disk
Video: $video

Network Information
-------------------
FQDN: $fqdn
Host Address: $host_address
Gateway IP: $gateway_ip
DNS Server: $dns_server

System Status
-------------
Users Logged In: $users_logged_in
Disk Space: $disk_space
Process Count: $process_count
Load Averages: $load_averages
Listening Network Ports: $listening_ports
UFW Status: $ufw_status

EOF


